## U课堂后台接口文档
ST-273018-plVQmiNcITvKfhXY9SKO-NlvE-ids1-1578315998726


### 一、用户权限类接口  
 * __用户登陆__

    -  地址：`https://1998gang.cn/uclass/api/usermanage`
    -  请求方式：`GET`
    -  请求参数：`code`（微信小程序临时身份认证码）
    -  请求结果：
      >  
      *  __200__  
      ```json  
        （学生）{"xh":"2017214033","xm":"彭渝刚","xb":"男","ykth":"1655728","yxm":"软件工程学院","zym":"软件工程","nj":"2017","bj":"13001701","xjzt":"在校","mz":"汉族 ","csrq":"19981030","stu_phone":"null","stu_email":"null","accountType":"s(s带表学生)","xkzt":"nul(此处忽略该字段)"}
        （教师）{"teaId":"030403","teaName":"向敏（经）","xb":"女","ykth":"0101303","zc":"教授","jysm":"应用经济学系","yxm":"经济管理学院","email":"xxxx@emil.com(教师的邮箱)","phone":"联系电话","accountType":"t（t代表老师）"}
      ```
      *  __415__  
        ```
        无数据返回，原因openid查询失败，可能原因是code不正确
        ```
      *  __401__  
        ```
        无数据返回，原因该用户没有绑定教务账户
        ```  
      *  __410__  
        ```
        无数据返回，原因是该用户的身份过期，需要重新绑定。
        ```
      *  __500__  
         ```
        无数据返回，服务器内部错误
         ```  



*  __用户绑定教务账户__

    -  地址：`https://1998gang.cn/uclass/api/usermanage`
    -  请求方式：`POST`
    -  请求参数：
    ```json
     {"ykth": "统一认证码", "password":"密码", "code":"微信小程序临时身份认证码"}
    ```
    -  请求结果：http响应状态码+提示信息
    >  
     *  __200__  
        ```
        “绑定成功”
        ```
     * __401__
       ```
       “绑定失败，不支持的教务账户类型”    非教师非学生账户的教务账户
       ```
     *  __403__
      ```
       “绑定失败（统一身份验证失败）”
       ```
     *  __415__
      ```
      “绑定失败，可能是无效code”
      ```
      *  __500__
      ```
         “绑定失败，服务器内部错误！”
      ```


* __完善用户信息__

   - 地址：`https://1998gang.cn/uclass/api/addinfo`
   - 请求方式：`POST`
   - 请求参数：
   ```json
   {"ykth":"一卡通号","email":"邮箱","phone":"电话号码"}
   ```
   - 请求结果：http响应状态码+响应提示信息
   >  
    * __200__  
    ```
    “完善成功”
    ```
    * __400__  
    ```
    “添加失败”
    ```
    * __500__  
    ```
    “服务器端位置错误”
    ```


### 二、课表功能接口
* __获取教师课表__  

    - 地址：`https://1998gang.cn/uclass/api/teakebiao`  
    - 请求方式：`GET`  
    - 请求参数：`teaId`教师号  
    - 请求结果：
    ```
    一、返回整个课表数据结构是一个三维数组，数组的单位是一个json对象。
          1.第一维度。（课表纵轴）代表一天上课的6个时间段（12、34、56、78、910、1112节）。[0]表示12节，[2]表示56节。  
          2.第二维度。（课表横轴）代表某一个时间段上课的是星期数（星期1、2、3、4、5、6、7）。[1][2]表示34节星期三，[2][3]表示56节星期四。
          3.第三维度。（具体位置的纵深）代表具体时间段的课程，同一时间可能有多门课。例如：星期一 34节有高数和大物。
    二、json对象数据含义。
          jxb：教学班，
          kch：课程号，
          kcm：课程名，
          skzs：上课周数（1-8周|1-16周单周|...）,
          skdd:上课地点，
          jsm：教师名
          kclb：课程类别（必修|选修），
          bjlbandbjh：班级类别和班级号（列举了上这门课的专业和班级）
          week：周（一个20位的10进制数。从左往右代表20周，第几位数字是1，就代表这一周有这一堂课）‘11111111000000000000’表示1-8周有课。
          weekNum：是一个数组，数据代表有课的周号‘["1","2","3","4","5","6","7","8"]’，列举了上课的周号
          work_day；表示这堂课在星期几上
          cStart：表示开始上课的节数。例如 3代表第3节开始。
          cTime：表示这堂课要上几节。例如 2表示上两节，3表示三节脸上课，4表示4节连上。  
    三、同一课程，在同一周不同时间上，数据是分开的。例如：高数在星期一34节、星期三56节都有课，在本数据中，是有两个josn对象去分别表示的。
    ```
    >  
     * __200__  
      ```json
      [[[{"jxb":"SJ13191A2130640003","kch":"A2130640","kcm":"课程设计（软件分析与设计）","skzs":"17周","skdd":"综合实验楼A503/A504","jsm":"王正军","kclb":"必修","credit":null,"bjlbandbjh":["软件工程","130017|01,03班"],"week":"00000000000000001000","weekNum":["17"],"weekday":"1","cStart":"1","cTimes":"4","cjzc":null}],[],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[{"jxb":"SJ13191A2130640004","kch":"A2130640","kcm":"课程设计（软件分析与设计）","skzs":"17周","skdd":"综合实验楼A503/A504","jsm":"王正军","kclb":"必修","credit":null,"bjlbandbjh":["软件工程","130017|04,07班"],"week":"00000000000000001000","weekNum":["17"],"weekday":"5","cStart":"5","cTimes":"4","cjzc":null}],[],[]],[[],[],[],[],[],[],[]],[[{"jxb":"SJ13191A2130640004","kch":"A2130640","kcm":"课程设计（软件分析与设计）","skzs":"17周","skdd":"综合实验楼A503/A504","jsm":"王正军","kclb":"必修","credit":null,"bjlbandbjh":["软件工程","130017|04,07班"],"week":"00000000000000001000","weekNum":["17"],"weekday":"1","cStart":"9","cTimes":"4","cjzc":null}],[],[],[],[],[],[]],[[],[],[],[],[],[],[]]]
      ```  
      * __500__  
      ```
      无响应参数，服务器内部错误！
      ```

* __获取学生课表__

    - 地址：`https://1998gang.cn/uclass/api/stukebiao`  
    - 请求方式：`GET`  
    - 请求参数：`xh`学号
    - 请求结果：
    ```
    一、返回整个课表数据结构是一个三维数组，数组的单位是一个json对象。
          1.第一维度。（课表纵轴）代表一天上课的6个时间段（12、34、56、78、910、1112节）。[0]表示12节，[2]表示56节。  
          2.第二维度。（课表横轴）代表某一个时间段上课的是星期数（星期1、2、3、4、5、6、7）。[1][2]表示34节星期三，[2][3]表示56节星期四。
          3.第三维度。（具体位置的纵深）代表具体时间段的课程，同一时间可能有多门课。例如：星期一 34节有高数和大物。
    二、json对象数据含义。
          jxb：教学班，
          kch：课程号，
          kcm：课程名，
          skzs：上课周数（1-8周|1-16周单周|...）,
          skdd:上课地点，
          jsm：教师名
          kclb：课程类别（必修|选修），
          credit：学分，
          week：周（一个20位的10进制数。从左往右代表20周，第几位数字是1，就代表这一周有这一堂课）‘11111111000000000000’表示1-8周有课。
          weekNum：是一个数组，数据代表有课的周号‘["1","2","3","4","5","6","7","8"]’，列举了上课的周号
          work_day；表示这堂课在星期几上
          cStart：表示开始上课的节数。例如 3代表第3节开始。
          cTime：表示这堂课要上几节。例如 2表示上两节，3表示三节脸上课，4表示4节连上。
          cjzc：这门课的成绩组成。字符串。  
    三、同一课程，在同一周不同时间上，数据是分开的。例如：高数在星期一34节、星期三56节都有课，在本数据中，是有两个josn对象去分别表示的。
    ```

      >  
        * __200__  
            ```json
            [[[{"jxb":"SJ13191A2130640003","kch":"A2130640","kcm":"课程设计（软件分析与设计）","skzs":"17周","skdd":"综合实验楼A503/A504","jsm":"王正军","kclb":"必修","credit":"1.0学分","xklx":null,"bjlbandbjh":null,"week":"00000000000000001000","weekNum":["17"],"workday":"1","cStart":"1","cTimes":"4","cjzc":"[实验实践]考勤占30%，课堂表现占30%，实验报告占40%"}],[{"jxb":"SJ13191A2130640003","kch":"A2130640","kcm":"课程设计（软件分析与设计）","skzs":"17周","skdd":"综合实验楼A503/A504","jsm":"王正军","kclb":"必修","credit":"1.0学分","bjlbandbjh":null,"week":"00000000000000001000","weekNum":["17"],"weekday":"2","cStart":"1","cTimes":"4","cjzc":null}],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[{"jxb":"A13191A1135010001","kch":"A1135010","kcm":"计算思维之方法学","skzs":"1-8周","skdd":"2102","jsm":"姜美兰","kclb":"选修","credit":"1.0学分","bjlbandbjh":null,"week":"11111111000000000000","weekNum":["1","2","3","4","5","6","7","8"],"weekday":"3","cStart":"7","cTimes":"2","cjzc":null},{"jxb":"SK13191A2130350001","kch":"A2130350","kcm":"计算机网络","skzs":"10-16周双周","skdd":"综合实验楼B413/B414","jsm":"曹岭","kclb":"必修","credit":".0学分","bjlbandbjh":null,"week":"00000000010101010000","weekNum":["10","12","14","16"],"weekday":"3","cStart":"7","cTimes":"2","cjzc":null}],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]]]
            ```
        * __500__  
            ```
            无响应参数，服务器内部错误！
            ```  

### 四、点名功能接口  
* __教师发起签到__  

  - 地址：`https://1998gang.cn/uclass/api/originateqiandao`  
  - 请求方式：`POST`  
  - 请求参数：
  ```json
  {"jxb":"教学班号","week":"上课周","work_day":"星期几","qdcs":"签到次数（针对这节课发起的第几次签到）","qdm":"签到码（由前端生成）","yxsj":"有效时间（如果签到时间设置2分钟，该值为120）"}
  ```
  - 请求结果： http响应状态码+响应提示信息
  >  
    * __200__  
    ```json
    {"massage":"发起签到成功!"}
    ```  
    * __417__  
    ```json
    {"massage":"发起失败!当前有签到正在进行！"}
    ```
    * __500__
    ```json
    {"massage":"发起签到失败，服务器端未知错误！"}
    ```  

* __教师获取当堂当次课签到结果__

  - 地址：`https://1998gang.cn/uclass/api/teaqiandaoresult`
  - 请求方式：`GET`
  - 请求参数：`jxb`教学班、`week`上课周、`work_day`星期几、`qdcs`签到次数（针对这节课发起的第几次签到）
  - 请求结果：`notOnTheStuList`装的是有记录的学生名单（包含未签到，迟到，请假）。`allStuNum`表示全部一共多少人。`notOnStuNum`表示未签到人数。`inStuNum`表示签了的人数。`beLateNum`表示迟到是人数。`askForLeaveNum`表示请假人数。
  >  
   * __200__  
   ```json
   {"notOnTheStuList":[{"xh":"2017214197","xm":"姚佳汐","xb":"男","yxm":"软件工程学院","zym":"软件工程","nj":"2017","bj":"13001704","xjzt":"在校","xkzt":"正常","qdzt":"QQ"},{},{}],"allStuNum":57,"notOnStuNum":54,"inStuNum":1,"beLateNum":1,"askForLeaveNum":1,"week":"18","work_day":"2","qdcs":"1","jxb":"SJ13191A2130640004"}  
   ```
   * __500__  
   ```
  服务器端未未知错误
   ```

* __教师给当堂当次未签学生补签__  

 - 地址：`https://1998gang.cn/uclass/api/tearetroactive`
 - 请求方式：`PUT`
 - 请求参数：
 ```json
 {"jxb":"A13191A2130440002（教学班号）","week":"18（上课周）","work_day":"1（星期几）","qdcs":"1（签到次数（针对这节课发起的第几次签到））","xh":"2017214033（补签学生学号）","bqlx":"QJ|CD|WT (补签类型,参数必须是前面列的三个中的一个。分别代表 请假|迟到|网络问题)"}
 ```
 - 请求结果：  
 >   
   * __200__
  ```json
  {"massage":"补签成功"}
  ```
   * __409__
  ```json
  {"massage":"补签失败"}
  ```
   * __500__
  ```json
  {"massage":"服务器内部错误"}
  ```

* __学生端获取剩余签到时间__  

   - 地址：`https://1998gang.cn/uclass/api/stugetqiandaotimeremaining`  
   - 请求方式：`GET`  
   - 请求参数：`jxb`教学班号、`week`上课周、`weekDay`星期几
   - 请求结果：  
   >  
    * __200__  
   ```json
   {"fqiandaosurplus":"102(签到剩余时间)","qdcs":"签到次数（这是的第几次签到）"}
   ```  
    * __404__  
    ```json
    {"massage":"未找到签到剩余时间。当前无签到"}
    ```
    * __500__  
    ```json
    {"massage":"服务器端未未知错误"}
    ```

* __学生签到__
  - 地址：`https://1998gang.cn/uclass/api/stuqiandao`  
  - 请求方式：`PUT`
  - 请求参数：
  ```json
  {"jxb":"教学班","week":"周","work_day":"xqj","qdcs":"签到次数（针对这节课发起的第几次签到）","qdm":"签到码","xh":"学号"}
  ```
  - 请求结果：
  >  
   * __200__  
   ```json
   {"massage":"签到成功！"}
   ```
   * __409__
   ```json
   {"massage":"签到失败！"}
   ```
   * __500__
   ```json
   {"massage":"服务器端未知错误！"}
   ```

* __学生获取本门课程的历史签到数据__  

  - 地址：`https://1998gang.cn/uclass/api/stuqiandaohistory`
  - 请求方式：`GET`
  - 请求参数：
  ```json
  {"xh":"学号","jxb":"教学班"}
  ```
  - 请求结果：
  >  
   * __200__
   ```json
   ```
   * __409__
   * __500__







### 五、课堂提问功能接口




### 六、其他类接口
* __获取当堂课程学生名单__

  - 地址：`https://1998gang.cn/uclass/api/kbstulist`
  - 请求方式：`GET`
  - 请求参数：`jxb`教学班号
  - 请求结果：
  ```
   students:学生列表
   headcount：总人数
   numberOfXkzt:不同选课状态对应的人数
   numberOfZyAndBj:不同专业下不同班级对应人数
  ```
  >  
    * __200__  
    ```json
    {"students":[{"xh":"2016214277","xm":"但瑶","xb":"女","yxm":"软件工程学院","zym":"软件工程","nj":"2016","bj":"13001603","xjzt":"在校","xkzt":"重修"},{},{}...],"headcount":73,"numberOfXkzt":{"重修":4,"正常":67,"补修":2},"numberOfZyAndBj":{"日语+软件":{"13071601":2,"13071701":35},"软件工程(留学生)":{"L1311701":3},"软件工程":{"13001603":1,"13001702":1,"13001701":29,"13001608":1,"13001605":1}}}
    ```  
    * __404__  
    ```
    "资源未找到"
    ```   
    * __500__  
    ```
    "服务器端出现未知错误！"
    ```
* __获取教务时间__  

  - 地址：`https://1998gang.cn/uclass/api/schooltime`
  - 请求方式：`GET`
  - 请求参数：无
  - 请求结果：http响应状态码+json数据
>  
   * __200__  
     ```json
     {"semester":"学期","year":"年","semester":"学年","day":"日","week":"周","month":"月","work_day":"星期几（工作日）"}
     ```   
   *  __500__
      ```json
      {"massage":"获取失败，服务器端未知错误"}
      ```


 * __反馈使用问题__  

    - 地址:`https://1998gang.cn/uclass/api/feedbackinfo`
    - 请求方式：`POST`
    - 请求参数：  
    ```json
    {"time":"反馈时间","ykth":"一卡通号","name":"用户姓名","userType":"学生|教师","phone":"电话号码","email":"邮箱","title":"问题题目","content":"问题内容"}
    ```
    - 请求结果：http响应状态码+响应提示信息
    >  
      * __200__  
      ```
     “反馈成功！”
     ```
      * __500__  
     ```
     "服务端未知错误！"
     ```
